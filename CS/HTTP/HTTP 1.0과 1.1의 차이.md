---
tags:
  - CS_지식의_정석
  - HTTP
---
# HTTP 1.0과 1.1의 차이와 요청을 줄이는 기술들

```table-of-contents
```

##  HTTP/1.0

- 수명이 짧은 연결
- 각 HTTP 요청당 [TCP 핸드쉐이크](../네트워크/3-way-handshake.md) 가 발생되어, 기본적으로 한 연결당 하나의 요청을 처리
	- 즉, 한 페이지를 구성하는 HTML, CSS, JS를 요청할 때마다 각각 핸드쉐이크 발생
	- 결과적으로 [RTT](../네트워크/네트워크.md) 가 늘어나는 문제점 발생


## HTTP/1.1

- 1.0의 단점을 보완한 프로토콜
- 크게 3가지 차이점

### 1. keep-alive default
- 매번 데이터를 요청할 때마다 TCP 연결을 하는 대신, 한번 해놓고 계속해서 데이터를 받을 수 있게끔하는 `keep-alive` 옵션을 기본으로 사용
- 응답 헤더에 Connection 헤더에 keep-alive, Keep-Alive 헤더에 `timeout=5`를 넣어주는 것으로 연결 유지시간 설정가능
- 또한 Keep-Alive 해더를 통해 최대 요청수 `max=` 값을 설정해 줄 수도 있음

### 2. 호스트 헤더
- 1.0의 경우 서버가 하나의 호스트만 가진다고 가정하기 떄문에, 헤더에 호스트를 따로 포함하지 않았음
- 그러나 서버는 여러개의 호스트를 가질 수 있으며, 이러한 유연성을 반영하기 위해 1.1에서는 헤더에 특정 호스트를 포함할 수 있게 변경
- 항상 호스트를 포함해서 요청하도록 변경됨

### 3. 대역폭 최적화
- 1.0의 경우 어떠한 하일을 다운로드 받다가 연결이 끊기면 처음부터 다시 받아야함
- 1.1에서는 `Range:bytes=5000-` 와 같은 헤더를 추가하여, 끊긴 지점부터 받는 것이 가능해짐


## 요청을 줄이는 기술

### 이미지 스프라이트
- 페이지에서 사용되는 여러 이미지들을 각각 요청하지 않고, 하나의 이미지로 만들어서 하나만 요청하도록 함
- 하나의 통합된 이미지를 받고, 거기서 각 요소에 필요한 이미지의 위치를 기준으로 사용하도록 함 (여러 아이콘을 붙여서 만들기 등)

### 코드압축
- 코드를 압축해서 서빙하는 것이 가능 (공백 최소화 등)

### 이미지 Base64 인코딩
- 이미지 파일을 64진법의 문자열로 인코딩하는 것
- 이미지 서버에 따로 요청하는 대신, 다른 코드와 같이 하나의 요청으로 받아올 수 있음
- 다만 파일크기가 평균 37퍼센트 늘어나는 단점은 있음

## HTTP/1.1의 문제점 : HOL

- 1.1의 경우에도 고질적으로 HOL 문제가 있음

### HOL(Head Of Line Blocking)

- 네트워크에서 같은 큐에 있는 패킷이 그 첫번째 패킷에 의해 지연될 때 발생하는 성능저하현상
	- 먼저 받는 이미지 파일의 크기가 커서 지연된다면, 그 뒤에 상대적으로 작은 JS나 HTML 파일들의 응답이 미뤄지게 되면서, 아무것도 띄우지 못하는 상태가 됨
- 이러한 현상을 해결하기 위해 HTTP/2 등장